{
  "meta": {
    "project_name": "Circle Picks - Social Recommendations MVP",
    "phase": "setup",
    "version": "0.3.0",
    "created": "2026-01-12",
    "last_updated": "2026-01-19",
    "purpose": "Step-by-step setup plan for frontend application with Supabase backend",
    "status": "MVP implemented - use as reference for future development"
  },
  "project_overview": {
    "type": "Mobile-first responsive web app",
    "framework": "Next.js 16.1.1 (App Router)",
    "react": "19.2.3",
    "language": "TypeScript 5.9.3",
    "styling": "Tailwind CSS 3.4.19",
    "backend": "Supabase (Auth, Database, Storage)",
    "state_management": "TanStack React Query 5.90.16 + local component state",
    "i18n": "next-intl 4.7.0 (pt-BR default, en-US)",
    "target": "Quick social recommendations app - save places in ~15 seconds"
  },
  "phase_1_initial_setup": {
    "order": 1,
    "title": "Project Initialization & Dependencies",
    "status": "completed",
    "steps": [
      {
        "id": "1.1",
        "task": "Initialize project",
        "action": "Run: npx create-next-app@latest",
        "flags": "--typescript --tailwind --app --src-dir"
      },
      {
        "id": "1.2",
        "task": "Install core dependencies",
        "packages": [
          "@tanstack/react-query@5.90.16",
          "react-hook-form@7.71.0",
          "clsx@2.1.1",
          "tailwind-merge@3.4.0",
          "next-intl@4.7.0"
        ]
      },
      {
        "id": "1.3",
        "task": "Install Supabase dependencies",
        "packages": [
          "@supabase/supabase-js@2.90.1",
          "@supabase/ssr@0.8.0"
        ]
      },
      {
        "id": "1.4",
        "task": "Install utility dependencies",
        "packages": [
          "browser-image-compression@2.0.2",
          "bcryptjs@3.0.3"
        ]
      },
      {
        "id": "1.5",
        "task": "Configure environment variables",
        "action": "Create .env.local with Supabase and Google credentials",
        "variables": {
          "NEXT_PUBLIC_SITE_URL": "Site URL for OAuth redirects",
          "NEXT_PUBLIC_SUPABASE_URL": "Your Supabase project URL",
          "NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY": "Client-side publishable key",
          "SUPABASE_SECRET_KEY": "Server-side secret key",
          "GOOGLE_PLACES_API_KEY": "Google Places API key"
        }
      }
    ]
  },
  "phase_2_folder_structure": {
    "order": 2,
    "title": "Create Feature-First Folder Structure",
    "status": "completed",
    "structure": {
      "app_directory": {
        "app/[locale]/": "Routes with i18n support",
        "app/[locale]/app/": "Authenticated app routes",
        "app/[locale]/auth/": "Authentication routes",
        "app/api/": "API routes (thin service layer)",
        "app/auth/callback/": "Supabase auth callback",
        "components/": "Shared/global UI components",
        "features/": {
          "auth/": "Authentication components, hooks",
          "feed/": "Feed screen components, hooks",
          "add/": "Quick Add flow components, hooks",
          "profile/": "Profile screen components, hooks",
          "experience-detail/": "Experience detail view",
          "explore/": "Explore feature components, hooks"
        },
        "hooks/": "Global custom hooks",
        "lib/": {
          "supabase/": "Supabase client utilities",
          "api/": "API utilities and facade",
          "models/": "TypeScript domain types/interfaces",
          "auth/": "AuthContext and auth utilities",
          "utils/": "Helper functions"
        },
        "i18n/": "i18n configuration",
        "locales/": "Translation files",
        "public/": "Static assets"
      }
    }
  },
  "phase_3_design_tokens": {
    "order": 3,
    "title": "Configure Design System & Tailwind",
    "status": "completed",
    "tokens": {
      "colors": {
        "primary": "#FD512E (with shades 100-900)",
        "background": "#FFFFFF",
        "surface": "#F6F7F9",
        "chip-bg": "#EDEEF1",
        "dark-grey": "#111111",
        "medium-grey": "#555555",
        "divider": "#E4E6EA"
      },
      "fontFamily": {
        "sans": ["Inter", "system-ui", "sans-serif"]
      },
      "fontSize": {
        "title-l": "1.125rem",
        "title-m": "1rem",
        "body": "0.875rem",
        "small": "0.75rem"
      },
      "borderRadius": {
        "chip": "8px",
        "surface": "10px"
      },
      "spacing": {
        "xs": "4px",
        "sm": "8px",
        "md": "16px",
        "lg": "24px"
      }
    }
  },
  "phase_4_domain_models": {
    "order": 4,
    "title": "Define TypeScript Domain Models",
    "status": "completed",
    "location": "src/lib/models/index.ts",
    "models": [
      "User",
      "AuthUser",
      "Place",
      "PlaceSearchResult",
      "PlaceStats",
      "Tag",
      "TagWithLabel",
      "Experience",
      "ExperienceDetail",
      "ExperienceFeedItem",
      "Bookmark",
      "Follow",
      "FollowWithUser",
      "OtherRecommender",
      "QuickAddFormState",
      "ExperienceCardProps",
      "PriceRange",
      "ExperienceVisibility"
    ]
  },
  "phase_5_supabase_setup": {
    "order": 5,
    "title": "Supabase Project & Database Setup",
    "status": "completed",
    "tables": {
      "users": {
        "description": "User profiles, extends auth.users",
        "columns": {
          "id": "UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE",
          "display_name": "TEXT NOT NULL",
          "username": "TEXT UNIQUE NOT NULL",
          "avatar_url": "TEXT",
          "created_at": "TIMESTAMPTZ DEFAULT NOW()"
        },
        "trigger": "handle_new_user() - Auto-creates profile on signup"
      },
      "places": {
        "description": "Places/locations (deduplicated)",
        "columns": {
          "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
          "google_place_id": "TEXT",
          "name": "TEXT NOT NULL",
          "city": "TEXT NOT NULL",
          "country": "TEXT NOT NULL",
          "address": "TEXT",
          "lat": "DECIMAL",
          "lng": "DECIMAL",
          "instagram_handle": "TEXT",
          "google_maps_url": "TEXT",
          "custom": "BOOLEAN DEFAULT false",
          "created_at": "TIMESTAMPTZ DEFAULT NOW()"
        }
      },
      "experiences": {
        "description": "User experiences at places",
        "columns": {
          "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
          "user_id": "UUID REFERENCES users(id) ON DELETE CASCADE NOT NULL",
          "place_id": "UUID REFERENCES places(id) ON DELETE CASCADE NOT NULL",
          "price_range": "TEXT CHECK (price_range IN ('$', '$$', '$$$', '$$$$'))",
          "tags": "TEXT[]",
          "brief_description": "TEXT",
          "phone_number": "TEXT",
          "images": "TEXT[]",
          "visit_date": "DATE",
          "visibility": "TEXT DEFAULT 'public' CHECK (visibility IN ('public', 'friends_only'))",
          "created_at": "TIMESTAMPTZ DEFAULT NOW()"
        }
      },
      "bookmarks": {
        "description": "User bookmarks on experiences",
        "columns": {
          "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
          "user_id": "UUID REFERENCES users(id) ON DELETE CASCADE NOT NULL",
          "experience_id": "UUID REFERENCES experiences(id) ON DELETE CASCADE NOT NULL",
          "created_at": "TIMESTAMPTZ DEFAULT NOW()"
        },
        "constraints": ["UNIQUE(user_id, experience_id)"]
      },
      "tags": {
        "description": "System and custom tags",
        "columns": {
          "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
          "slug": "TEXT UNIQUE NOT NULL",
          "display_name": "TEXT",
          "is_system": "BOOLEAN DEFAULT false",
          "created_by": "UUID REFERENCES users(id)",
          "created_at": "TIMESTAMPTZ DEFAULT NOW()"
        }
      },
      "follows": {
        "description": "User follow relationships",
        "columns": {
          "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
          "follower_id": "UUID REFERENCES users(id) ON DELETE CASCADE NOT NULL",
          "following_id": "UUID REFERENCES users(id) ON DELETE CASCADE NOT NULL",
          "created_at": "TIMESTAMPTZ DEFAULT NOW()"
        },
        "constraints": [
          "UNIQUE(follower_id, following_id)",
          "CHECK(follower_id != following_id)"
        ]
      }
    },
    "storage_buckets": [
      {
        "name": "experience-images",
        "public": true,
        "description": "Images uploaded for experiences"
      },
      {
        "name": "avatars",
        "public": true,
        "description": "User profile pictures"
      }
    ],
    "rls_policies": {
      "users": [
        "Users can read any profile",
        "Users can update own profile",
        "Users can insert own profile"
      ],
      "places": [
        "Anyone can read places",
        "Authenticated users can create places"
      ],
      "experiences": [
        "Users see: own + public + friends_only from followed users",
        "Users can only CRUD their own experiences"
      ],
      "bookmarks": [
        "Users can only see/manage their own bookmarks"
      ],
      "tags": [
        "Anyone can read tags",
        "Authenticated users can create custom tags"
      ],
      "follows": [
        "Users can see all follows",
        "Users can only create/delete their own follows"
      ]
    }
  },
  "phase_6_supabase_auth": {
    "order": 6,
    "title": "Supabase Authentication Setup",
    "status": "completed",
    "providers": {
      "email_password": {
        "status": "implemented",
        "features": ["signup", "signin", "signout"]
      },
      "google_oauth": {
        "status": "stub only - not fully implemented"
      }
    },
    "client_utilities": {
      "lib/supabase/client.ts": "Browser client (createBrowserClient)",
      "lib/supabase/server.ts": "Server client (createServerClient with secret key)",
      "lib/supabase/middleware.ts": "Middleware client (updateSession)"
    },
    "auth_context": {
      "location": "lib/auth/AuthContext.tsx",
      "hook": "useAuth()",
      "features": [
        "Manages user state globally",
        "Listens for auth state changes",
        "Fetches user profile from database"
      ]
    }
  },
  "phase_7_api_layer": {
    "order": 7,
    "title": "Setup API Layer with Supabase",
    "status": "completed",
    "api_facade": {
      "location": "lib/api/endpoints.ts",
      "description": "Central API facade for all endpoints"
    },
    "react_query": {
      "provider": "Providers component with QueryClientProvider",
      "hooks": [
        "useFeed()",
        "useExperience(id)",
        "useProfile(userId)",
        "useCreateExperience()",
        "useExperienceMutations()",
        "useToggleBookmark()",
        "useBookmarks()",
        "useTags()",
        "useCreateTag()",
        "useFollow()",
        "useFollowStatus()",
        "useExplore()"
      ]
    }
  },
  "phase_8_global_components": {
    "order": 8,
    "title": "Build Global/Shared Components",
    "status": "completed",
    "components": [
      "BottomNav",
      "Sidebar",
      "DesktopNav",
      "TopBar",
      "Avatar",
      "Chip",
      "Button",
      "Input",
      "TextArea",
      "IconButton",
      "SearchBar",
      "Breadcrumb",
      "LanguageSwitcher",
      "LoadingSpinner",
      "ErrorMessage",
      "PlaceholderImage",
      "VisibilityBadge",
      "FollowButton",
      "Toast",
      "ToastContainer",
      "FloatingActionButton",
      "Stories",
      "AuthGuard",
      "UserDropdown",
      "UserMenu",
      "Providers"
    ]
  },
  "phase_9_auth_screens": {
    "order": 9,
    "title": "Build Authentication Screens",
    "status": "completed",
    "screens": [
      {
        "name": "Sign In",
        "path": "app/[locale]/auth/signin/page.tsx",
        "components": ["SignInForm"]
      },
      {
        "name": "Sign Up",
        "path": "app/[locale]/auth/signup/page.tsx",
        "components": ["SignUpForm"]
      },
      {
        "name": "Auth Error",
        "path": "app/[locale]/auth/error/page.tsx"
      }
    ]
  },
  "phase_10_core_screens": {
    "order": 10,
    "title": "Build Core Screens",
    "status": "completed",
    "screens": {
      "feed": {
        "path": "app/[locale]/app/page.tsx",
        "features": ["mySuggestions", "friendsSuggestions", "communitySuggestions", "nearbyPlaces"]
      },
      "experience_detail": {
        "path": "app/[locale]/app/experience/[id]/[slug]/page.tsx",
        "features": ["Full details", "Bookmark", "Other recommenders", "More from user"]
      },
      "experience_edit": {
        "path": "app/[locale]/app/experience/[id]/edit/page.tsx",
        "features": ["Edit price, tags, description, images, visibility"]
      },
      "quick_add": {
        "path": "app/[locale]/app/add/page.tsx",
        "features": ["Place search", "Price", "Tags", "Images", "Visibility"]
      },
      "profile": {
        "paths": [
          "app/[locale]/app/profile/me/page.tsx",
          "app/[locale]/app/profile/[userId]/page.tsx"
        ],
        "features": ["Stats", "Experiences tab", "Bookmarks tab", "Follow button", "Edit profile"]
      }
    }
  },
  "phase_11_routing": {
    "order": 11,
    "title": "Setup Routing & Navigation",
    "status": "completed",
    "routes": {
      "public": [
        "/[locale]/ (landing)",
        "/[locale]/auth/signin",
        "/[locale]/auth/signup",
        "/[locale]/auth/error",
        "/[locale]/app/explore/*"
      ],
      "protected": [
        "/[locale]/app/ (feed)",
        "/[locale]/app/add",
        "/[locale]/app/profile/me",
        "/[locale]/app/experience/[id]/edit"
      ]
    },
    "i18n": {
      "locales": ["pt-BR (default)", "en-US"],
      "prefix": "as-needed (no /pt-BR for default)"
    }
  },
  "phase_12_location_handling": {
    "order": 12,
    "title": "Implement Location Context Logic",
    "status": "completed",
    "flow": [
      "1. Try Geolocation API (navigator.geolocation)",
      "2. If denied/failed - Use Vercel geolocation headers",
      "3. If both fail - Show CitySelector component"
    ],
    "hook": "useLocationContext() in features/add/hooks/"
  },
  "phase_13_error_loading_states": {
    "order": 13,
    "title": "Implement Error & Loading States",
    "status": "completed",
    "components": [
      "LoadingSpinner",
      "ErrorMessage",
      "FeedEmptyState"
    ],
    "empty_states": [
      "Feed empty - 'Follow friends to discover places they love.'",
      "Profile empty - 'Save places to build your profile.'",
      "No search results - 'No places found.'"
    ]
  },
  "phase_14_responsive_layout": {
    "order": 14,
    "title": "Ensure Responsive Design",
    "status": "completed",
    "breakpoints": {
      "mobile": "320-414px",
      "tablet": "~768px",
      "desktop": "1024+ (max 1760px)"
    },
    "navigation": {
      "mobile": "BottomNav",
      "desktop": "Sidebar + TopBar"
    }
  },
  "phase_15_testing_qa": {
    "order": 15,
    "title": "Testing & Quality Assurance",
    "status": "optional for MVP",
    "manual_testing": [
      "Auth flows (signup, signin, signout)",
      "Quick Add flow end-to-end",
      "Feed with all sections",
      "Experience detail and bookmark",
      "Profile and edit",
      "Explore filtering"
    ]
  },
  "phase_16_tags_system": {
    "order": 16,
    "title": "Database-Backed Tags System",
    "status": "completed",
    "features": [
      "Tags table with system and custom tags",
      "System tags seeded with Portuguese display_names",
      "Slug normalization for deduplication",
      "Custom tags preserve user input via display_name",
      "i18n resolution via useTagLabel() hook"
    ],
    "api": {
      "GET /api/tags": "Fetch all tags",
      "POST /api/tags": "Create custom tag"
    }
  },
  "phase_17_follow_visibility": {
    "order": 17,
    "title": "Follow System & Visibility",
    "status": "completed",
    "features": [
      "Follows table for user relationships",
      "Visibility column on experiences (public/friends_only)",
      "RLS policies for visibility enforcement",
      "Feed filtering based on visibility and follows",
      "FollowButton component",
      "VisibilitySelector component"
    ],
    "api": {
      "POST /api/follow/[userId]": "Toggle follow/unfollow"
    }
  },
  "phase_18_explore": {
    "order": 18,
    "title": "Explore Feature",
    "status": "completed",
    "pages": [
      "/app/explore (hub)",
      "/app/explore/all",
      "/app/explore/cities",
      "/app/explore/tag/[slug]"
    ],
    "features": [
      "Browse by tag with counts",
      "Browse by city with counts",
      "Recent public experiences",
      "Filtering and pagination"
    ],
    "api": {
      "GET /api/explore": "Explore data with aggregations"
    }
  },
  "critical_principles": {
    "performance": [
      "Use React Query for server state caching",
      "Memoize heavy lists/cards where needed",
      "Image compression before upload",
      "Use Suspense or skeleton loading states"
    ],
    "architecture": [
      "Feature-first folders, not component-type folders",
      "Use Supabase client directly in React Query hooks",
      "Avoid unnecessary global state",
      "Mirror Supabase database types for consistency",
      "RLS policies enforce data access at database level",
      "AuthContext provides user state via React Context"
    ],
    "security": [
      "Never expose SUPABASE_SECRET_KEY to the client",
      "Use RLS policies for all data access",
      "Validate user input on both client and server",
      "Use httpOnly cookies for session storage (via @supabase/ssr)",
      "Visibility restrictions enforced at database level"
    ],
    "ux": [
      "Quick Add must be ~15 seconds",
      "Handle GPS/IP/manual location gracefully",
      "Never allow manual google_maps_url",
      "Explicit empty/error/loading states",
      "Immediate UI feedback for actions"
    ],
    "accessibility": [
      "44px minimum touch targets",
      "Visible focus states",
      "AA color contrast",
      "aria-labels on navigation",
      "Keyboard navigation support"
    ]
  },
  "current_state": {
    "description": "MVP is fully implemented with all core features working",
    "implemented": [
      "Email/password authentication",
      "User profiles with edit",
      "Create/edit/delete experiences",
      "Place search and custom places",
      "Place deduplication",
      "Price range and tags",
      "Image upload with compression",
      "Experience visibility",
      "Bookmarks",
      "User follow system",
      "Personalized feed with sections",
      "Explore with filtering",
      "Search",
      "Multi-language support"
    ],
    "not_implemented": [
      "Google OAuth (stub only)",
      "Comments/discussions",
      "Notifications",
      "Dark mode",
      "Password reset",
      "Email verification"
    ]
  }
}
